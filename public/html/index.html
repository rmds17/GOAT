<!doctype html>
<html lang="pt">
<head>
  <meta charset="utf-8" />
  <title>GOAT — Gestão Organizada de Ativos e Trabalho</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <link rel="stylesheet" href="../css/style.css" />
  <!-- APS Viewer CSS -->
  <link rel="stylesheet" href="https://developer.api.autodesk.com/modelderivative/v2/viewers/7.*/style.min.css" type="text/css">
  <style>
    body { margin: 0; background: white; }
    .layout { display: grid; grid-template-columns: 1.4fr 1fr; height: 100vh; gap: 0; }
    #viewerContainer { background: #f0f0f0; position: relative; }
    .right { background: white; overflow: auto; padding: 15px; border-left: 1px solid #ddd; }
    .urn-loader { margin-bottom: 20px; padding: 12px; background: #f0f5ff; border-radius: 6px; border: 1px solid #d0e0ff; }
    .urn-loader label { display: block; font-weight: bold; margin-bottom: 6px; }
    .urn-loader input { width: 100%; padding: 8px; margin: 6px 0; border: 1px solid #ccc; border-radius: 4px; font-size: 12px; }
    .urn-loader button { width: 100%; padding: 8px; background: #0066cc; color: white; border: none; border-radius: 4px; cursor: pointer; font-weight: bold; }
    .urn-loader button:hover { background: #0052a3; }
  </style>
</head>

<body>
  <div class="layout">
    <!-- 3D Viewer Container -->
    <div id="viewerContainer"></div>
    <!-- Painel OT -->
    <section class="right">
      <h2>Nova OT</h2>
      
      <!-- URN Loader -->
      <div class="urn-loader">
        <label>Carregar Modelo 3D</label>
        <input id="f-urn" type="text" placeholder="Cole o URN do modelo aqui..." />
        <button type="button" onclick="handleLoadModel()">Carregar Modelo</button>
      </div>
      
      <form id="wo-form" class="form">
        <label>Título
          <input id="f-title" required placeholder="Ex.: Porta não fecha" />
        </label>

        <label>Prioridade
          <select id="f-priority">
            <option>Low</option><option selected>Medium</option>
            <option>High</option><option>Urgent</option>
          </select>
        </label>

        <label>Data limite
          <input id="f-due" type="date" />
        </label>

        <label>Ativo / Zona
          <input id="f-asset" placeholder="Ex.: Bloco A - Piso 1" />
        </label>

        <label>Descrição
          <textarea id="f-desc" placeholder="Explica o problema e o que já foi observado..."></textarea>
        </label>

        <fieldset class="picked">
          <legend>Elemento selecionado</legend>
          <div><b>GlobalId:</b> <span id="picked-gid">—</span></div>
          <div><b>Tipo:</b> <span id="picked-type">—</span></div>
        </fieldset>

        <button type="submit">Criar OT</button>
      </form>

      <h2>Status</h2>
      <ul id="wo-list" class="wo-list"></ul>
      <p id="wo-empty" style="display:none">Ainda não há OT's.</p>
    </section>
  </div>

  <!-- APS Viewer Library -->
  <script src="https://developer.api.autodesk.com/modelderivative/v2/viewers/7.*/viewer3D.min.js"></script>
  
  <!-- Application Scripts -->
  <script src="../js/airtable.js"></script>
  <script src="../js/aps-viewer.js"></script>
</body>
</html>
